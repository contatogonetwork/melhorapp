# Prompt T√©cnico: Diretrizes para Desenvolvimento e Implanta√ß√£o com Streamlit Community Cloud

## Estrutura de Arquivos Recomendada para Streamlit Community Cloud

```markdown name=estrutura_streamlit.md
# Estrutura Recomendada para Aplica√ß√µes Streamlit

gonetwork_web/
‚îú‚îÄ‚îÄ app.py                  # Ponto de entrada principal (obrigat√≥rio)
‚îú‚îÄ‚îÄ requirements.txt        # Lista de depend√™ncias (obrigat√≥rio)
‚îú‚îÄ‚îÄ .streamlit/             # Configura√ß√µes do Streamlit
‚îÇ   ‚îú‚îÄ‚îÄ config.toml         # Configura√ß√µes de tema e interface
‚îÇ   ‚îî‚îÄ‚îÄ secrets.toml        # Segredos locais (N√ÉO comitar no GitHub)
‚îú‚îÄ‚îÄ .gitignore              # Controle de arquivos ignorados pelo Git
‚îú‚îÄ‚îÄ pages/                  # P√°ginas adicionais (sistema multi-page)
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.py        # Exemplo: Dashboard principal
‚îÇ   ‚îú‚îÄ‚îÄ clientes.py         # Exemplo: Gest√£o de clientes
‚îÇ   ‚îî‚îÄ‚îÄ relatorios.py       # Exemplo: Relat√≥rios e an√°lises
‚îú‚îÄ‚îÄ components/             # Componentes de UI reutiliz√°veis
‚îÇ   ‚îú‚îÄ‚îÄ sidebar.py          # Exemplo: Componente de barra lateral
‚îÇ   ‚îî‚îÄ‚îÄ authentication.py   # Exemplo: Componente de autentica√ß√£o
‚îú‚îÄ‚îÄ utils/                  # Fun√ß√µes utilit√°rias
‚îÇ   ‚îú‚îÄ‚îÄ data_processing.py  # Exemplo: Processamento de dados
‚îÇ   ‚îî‚îÄ‚îÄ network_tools.py    # Exemplo: Ferramentas espec√≠ficas de rede
‚îú‚îÄ‚îÄ assets/                 # Recursos est√°ticos
‚îÇ   ‚îú‚îÄ‚îÄ images/             # Imagens e √≠cones
‚îÇ   ‚îú‚îÄ‚îÄ css/                # Arquivos CSS personalizados
‚îÇ   ‚îî‚îÄ‚îÄ logo.png            # Logo da aplica√ß√£o
‚îî‚îÄ‚îÄ data/                   # Arquivos de dados locais (se necess√°rio)
    ‚îú‚îÄ‚îÄ sample_data.csv     # Dados de exemplo
    ‚îî‚îÄ‚îÄ config.json         # Configura√ß√µes em formato JSON
```

## Limita√ß√µes do Streamlit Community Cloud

1. **Recursos Computacionais**:
   - Ambiente compartilhado com recursos limitados (CPU/RAM)
   - Aplica√ß√µes hibernam ap√≥s per√≠odo sem uso (geralmente 7 dias)
   - Tempo limite de 60 segundos para carregar a p√°gina inicial

2. **Armazenamento e Persist√™ncia**:
   - Sem armazenamento persistente nativo (usar servi√ßos externos para dados persistentes)
   - Qualquer arquivo criado durante a execu√ß√£o √© tempor√°rio e n√£o persiste ap√≥s reinicializa√ß√µes
   - Aplica√ß√µes s√£o reiniciadas periodicamente (n√£o dependa de mem√≥ria em cache de longo prazo)

3. **Rede e Seguran√ßa**:
   - Acesso apenas a hosts p√∫blicos (n√£o acessa redes privadas)
   - Apenas portas HTTP/HTTPS s√£o acess√≠veis
   - N√£o permite execu√ß√£o de c√≥digo arbitr√°rio no shell
   - N√£o permite instala√ß√£o de pacotes de sistema (apt, yum, etc.)
   - N√£o suporta bibliotecas que requerem compiladores C/C++ complexos

## Boas Pr√°ticas para Desenvolvimento Streamlit

1. **Gerenciamento de Estado**:
   ```python
   # Inicializar vari√°veis de estado no in√≠cio do script
   if "authenticated" not in st.session_state:
       st.session_state.authenticated = False

   if "user_data" not in st.session_state:
       st.session_state.user_data = None

   # Manipular estado
   def login_user(username, password):
       # Autentica√ß√£o bem-sucedida
       st.session_state.authenticated = True
       st.session_state.username = username
   ```

2. **Otimiza√ß√£o de Performance**:
   ```python
   # Cache para dados que n√£o mudam frequentemente
   @st.cache_data(ttl=3600)  # Cache de 1 hora
   def load_large_dataset():
       return pd.read_csv("large_data.csv")

   # Cache para recursos compartilhados (modelos, conex√µes)
   @st.cache_resource
   def get_database_connection():
       return create_connection_to_database()
   ```

3. **Gest√£o de Segredos (Importante)**:
   - **Desenvolvimento local**: Use `.streamlit/secrets.toml` (adicione ao .gitignore)
   - **Em produ√ß√£o**: Configure via painel web do Streamlit Community Cloud
   ```python
   # Acessar segredos em c√≥digo
   api_key = st.secrets["api_keys"]["service_name"]
   db_password = st.secrets["db_credentials"]["password"]
   ```

4. **Layouts Responsivos**:
   ```python
   # Exemplo de layout responsivo com colunas
   col1, col2 = st.columns([2, 1])  # Propor√ß√£o 2:1

   with col1:
       st.header("Conte√∫do Principal")
       st.write("Ocupa 2/3 da largura dispon√≠vel")

   with col2:
       st.header("Painel Lateral")
       st.write("Ocupa 1/3 da largura dispon√≠vel")
   ```

5. **Organiza√ß√£o Multi-p√°gina**:
   - Arquivos Python na pasta `pages/` s√£o automaticamente reconhecidos como p√°ginas
   - A ordem √© controlada por 01_, 02_ prefixos no nome do arquivo
   - Cada arquivo deve ser independente e funcionar sozinho

## Arquivos de Configura√ß√£o

```toml name=.streamlit/config.toml
# Configura√ß√µes de tema
[theme]
primaryColor = "#1E88E5"
backgroundColor = "#FFFFFF"
secondaryBackgroundColor = "#F0F2F6"
textColor = "#262730"
font = "sans serif"

# Configura√ß√µes do servidor
[server]
headless = true
port = 8501
enableCORS = false

# Configura√ß√µes de browser
[browser]
gatherUsageStats = false
serverAddress = "localhost"
serverPort = 8501

# Comportamento do cache
[runner]
magicEnabled = true
installTracker = true
```

```gitignore name=.gitignore
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
env/
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
*.egg-info/
.installed.cfg
*.egg

# Ambientes virtuais
venv/
.venv/
ENV/
env/

# Streamlit espec√≠fico
.streamlit/secrets.toml

# Arquivos de banco de dados
*.db
*.sqlite3
gonetwork.db

# Arquivos locais
.env
.local
node_modules/

# Logs
logs/
*.log
npm-debug.log*

# Arquivos tempor√°rios
.DS_Store
.idea/
.vscode/
*.swp
*.swo
*~
```

## Arquivo de Depend√™ncias (requirements.txt)

```txt name=requirements.txt
# Depend√™ncia principal - especificar vers√£o exata
streamlit==1.29.0

# Processamento de dados
pandas==2.0.3
numpy==1.24.3

# Visualiza√ß√£o
plotly==5.15.0
matplotlib==3.7.2

# UI aprimorada
streamlit-option-menu==0.3.2
streamlit-authenticator==0.2.2
streamlit-extras==0.3.0

# Utilit√°rios
requests==2.31.0
pillow==9.5.0
pyyaml==6.0.1
watchdog==3.0.0

# Para desenvolvimento local apenas
# python-dotenv==1.0.0  # Descomente para desenvolvimento local
```

## Exemplo de P√°gina (briefing.py)

```python name=pages/briefing.py
import streamlit as st
import pandas as pd
import plotly.express as px
from datetime import datetime, timedelta

# Configura√ß√£o da p√°gina
st.set_page_config(
    page_title="Briefing do Cliente - GoNetwork Web",
    page_icon="üìã",
    layout="wide"
)

def load_client_data(client_id):
    """
    Carrega dados do cliente (simulado para exemplo).
    Na vers√£o real, buscaria do banco de dados ou API.
    """
    # Simula√ß√£o de dados
    return {
        "id": client_id,
        "nome": "Empresa XYZ Tecnologia",
        "responsavel": "Jo√£o Silva",
        "contato": "(11) 98765-4321",
        "email": "joao.silva@xyztech.com",
        "plano": "Empresarial Plus",
        "data_inicio": "2024-01-15",
        "status": "Ativo"
    }

def load_network_metrics(client_id):
    """
    Carrega m√©tricas de rede do cliente (simulado).
    """
    # Simula√ß√£o de dados de tr√°fego para √∫ltimos 7 dias
    dates = [datetime.now() - timedelta(days=i) for i in range(7, 0, -1)]

    return pd.DataFrame({
        "data": dates,
        "download_gb": [45.2, 38.7, 52.1, 41.3, 39.8, 47.5, 51.2],
        "upload_gb": [12.3, 10.5, 14.2, 11.8, 10.9, 13.1, 14.8],
        "latencia_ms": [18, 22, 17, 19, 21, 18, 16]
    })

def load_tickets(client_id):
    """
    Carrega hist√≥rico de tickets (simulado).
    """
    return [
        {"id": "T1001", "data": "2024-05-15", "titulo": "Lentid√£o no acesso", "status": "Resolvido"},
        {"id": "T1042", "data": "2024-05-10", "titulo": "Configura√ß√£o de VPN", "status": "Resolvido"},
        {"id": "T1087", "data": "2024-05-18", "titulo": "Queda de conex√£o intermitente", "status": "Em andamento"}
    ]

def display_client_info(client_data):
    """
    Exibe informa√ß√µes do cliente.
    """
    st.header("Informa√ß√µes do Cliente")
    col1, col2 = st.columns(2)

    with col1:
        st.subheader(client_data["nome"])
        st.write(f"**Respons√°vel:** {client_data['responsavel']}")
        st.write(f"**Contato:** {client_data['contato']}")
        st.write(f"**Email:** {client_data['email']}")

    with col2:
        st.metric("Plano", client_data["plano"])
        st.write(f"**Data de In√≠cio:** {client_data['data_inicio']}")

        # Status com cor condicional
        status = client_data["status"]
        if status == "Ativo":
            st.success(f"**Status:** {status}")
        elif status == "Pendente":
            st.warning(f"**Status:** {status}")
        else:
            st.error(f"**Status:** {status}")

def display_network_metrics(metrics_data):
    """
    Exibe m√©tricas de rede com gr√°ficos.
    """
    st.header("M√©tricas de Rede")

    # Tabs para diferentes visualiza√ß√µes
    tab1, tab2, tab3 = st.tabs(["Tr√°fego", "Lat√™ncia", "Resumo"])

    with tab1:
        # Gr√°fico de tr√°fego
        fig = px.line(
            metrics_data,
            x="data",
            y=["download_gb", "upload_gb"],
            title="Tr√°fego Di√°rio (GB)",
            labels={"value": "GB", "data": "Data", "variable": "Tipo"},
            color_discrete_map={"download_gb": "#1E88E5", "upload_gb": "#FFC107"}
        )
        fig.update_layout(height=400)
        st.plotly_chart(fig, use_container_width=True)

    with tab2:
        # Gr√°fico de lat√™ncia
        fig = px.line(
            metrics_data,
            x="data",
            y="latencia_ms",
            title="Lat√™ncia M√©dia Di√°ria (ms)",
            labels={"latencia_ms": "Lat√™ncia (ms)", "data": "Data"},
            color_discrete_sequence=["#4CAF50"]
        )
        fig.update_layout(height=400)
        st.plotly_chart(fig, use_container_width=True)

    with tab3:
        # Resumo de m√©tricas
        col1, col2, col3 = st.columns(3)
        with col1:
            total_download = metrics_data["download_gb"].sum()
            st.metric("Download Total (7 dias)", f"{total_download:.1f} GB")

        with col2:
            total_upload = metrics_data["upload_gb"].sum()
            st.metric("Upload Total (7 dias)", f"{total_upload:.1f} GB")

        with col3:
            avg_latency = metrics_data["latencia_ms"].mean()
            st.metric("Lat√™ncia M√©dia", f"{avg_latency:.1f} ms")

def display_tickets(tickets_data):
    """
    Exibe hist√≥rico de tickets.
    """
    st.header("Hist√≥rico de Tickets")

    if not tickets_data:
        st.info("Nenhum ticket encontrado para este cliente.")
        return

    # Converter para DataFrame para exibi√ß√£o em tabela
    df = pd.DataFrame(tickets_data)

    # Aplicar estilo condicional com base no status
    def highlight_status(val):
        color = {
            "Resolvido": "green",
            "Em andamento": "orange",
            "Aberto": "red"
        }
        return f"background-color: {color.get(val, '')}"

    # Exibir tabela estilizada
    st.dataframe(
        df.style.applymap(highlight_status, subset=["status"]),
        use_container_width=True,
        hide_index=True
    )

def main():
    """
    Fun√ß√£o principal que controla o fluxo da p√°gina.
    """
    st.title("üìã Briefing do Cliente")

    # Barra lateral para sele√ß√£o do cliente (em uma app real, buscar do banco)
    with st.sidebar:
        st.header("Sele√ß√£o de Cliente")
        client_id = st.selectbox(
            "Escolha um cliente:",
            options=["C1001", "C1002", "C1003"],
            format_func=lambda x: f"{x} - Empresa XYZ" if x == "C1001" else f"{x} - Cliente {x[1:]}",
            index=0
        )

        st.divider()

        # Filtros adicionais
        st.subheader("Filtros")
        date_range = st.date_input(
            "Per√≠odo de an√°lise",
            value=[datetime.now() - timedelta(days=7), datetime.now()],
            max_value=datetime.now()
        )

        # Bot√£o para gerar relat√≥rio
        if st.button("üìä Gerar Relat√≥rio PDF", type="primary"):
            st.success("Relat√≥rio gerado com sucesso!")
            with st.spinner("Aguarde o download..."):
                st.download_button(
                    label="‚¨áÔ∏è Download Relat√≥rio",
                    data=b"Simula√ß√£o de PDF",  # Em uma app real, gerar PDF real
                    file_name=f"briefing_cliente_{client_id}_{datetime.now().strftime('%Y%m%d')}.pdf",
                    mime="application/pdf",
                )

    # Carregar dados do cliente selecionado
    client_data = load_client_data(client_id)
    network_metrics = load_network_metrics(client_id)
    tickets = load_tickets(client_id)

    # Exibir informa√ß√µes
    display_client_info(client_data)
    st.divider()
    display_network_metrics(network_metrics)
    st.divider()
    display_tickets(tickets)

    # Se√ß√£o de notas e observa√ß√µes
    st.header("Notas e Observa√ß√µes")
    notes = st.text_area(
        "Adicionar observa√ß√£o",
        placeholder="Insira notas importantes sobre este cliente...",
        height=100
    )

    if st.button("Salvar Observa√ß√£o"):
        st.success("Observa√ß√£o salva com sucesso!")
        # Em uma app real, salvar no banco de dados

# Executar a app
if __name__ == "__main__":
    main()
```

## Comandos para Desenvolvimento Local

```bash name=comandos_locais.sh
# Criar ambiente virtual
python -m venv .venv
source .venv/bin/activate  # No Windows: .venv\Scripts\activate

# Instalar depend√™ncias
pip install -r requirements.txt

# Desenvolvimento local com auto-reload
streamlit run app.py --server.runOnSave=true

# Verificar depend√™ncias instaladas
pip freeze > requirements_full.txt

# Testar modo de produ√ß√£o local
streamlit run app.py --server.headless=true
```

## Instru√ß√µes de Deploy no Streamlit Community Cloud

```markdown name=instrucoes_deploy.md
# Instru√ß√µes Completas para Deploy no Streamlit Community Cloud

## 1. Prepara√ß√£o do Reposit√≥rio

- Certifique-se de que `app.py` est√° no caminho correto (raiz ou subdiret√≥rio)
- Verifique se `requirements.txt` est√° completo e com vers√µes espec√≠ficas
- **IMPORTANTE**: Adicione `.streamlit/secrets.toml` ao `.gitignore`
- Commite todas as altera√ß√µes locais e fa√ßa push para o GitHub

## 2. Deploy no Streamlit Community Cloud

1. Acesse [https://share.streamlit.io/](https://share.streamlit.io/)
2. Fa√ßa login com sua conta GitHub
3. Clique em "New app"
4. Selecione o reposit√≥rio `contatogonetwork/melhorapp`
5. Escolha a branch principal (geralmente `main` ou `master`)
6. No campo **"Main file path"**, especifique:
   - Se app estiver na raiz: `app.py`
   - Se estiver no subdiret√≥rio: `gonetwork_web/app.py`
7. Clique em "Advanced settings" e configure:
   - **Python Version**: Escolha a vers√£o compat√≠vel (recomendado 3.9+)
   - **Packages**: O sistema usa o requirements.txt automaticamente
   - **Secrets**: Adicione todos os segredos/API keys necess√°rios (equivalente ao seu arquivo local secrets.toml)

8. Clique em "Deploy!" e aguarde a conclus√£o

## 3. Ap√≥s o Deploy

- Verifique os logs para poss√≠veis erros
- Teste todas as funcionalidades principais
- Verifique se os segredos est√£o funcionando
- Compartilhe o link com sua equipe/clientes

## 4. Gerenciamento Cont√≠nuo

- Qualquer push para a branch selecionada atualiza automaticamente a aplica√ß√£o
- Para atualiza√ß√µes de segredos, use o painel do Streamlit Community Cloud
- Para depura√ß√£o, use o bot√£o "Manage app" e verifique os logs
- Para desativar temporariamente, use a op√ß√£o "Sleep app"

## Solu√ß√£o de Problemas Comuns

- **Erro de importa√ß√£o de m√≥dulos**: Verifique o caminho relativo das importa√ß√µes
- **Erro de depend√™ncia**: Verifique se todas as bibliotecas est√£o no requirements.txt
- **Erro de segredos**: Verifique se adicionou os segredos no painel do Streamlit Cloud
- **Tempo de carregamento excedido**: Otimize o c√≥digo para carregar em menos de 60 segundos
- **Erro de arquivo n√£o encontrado**: Verifique o caminho do arquivo principal

## Resources Adicionais

- [Documenta√ß√£o Oficial do Streamlit](https://docs.streamlit.io/)
- [F√≥rum da Comunidade Streamlit](https://discuss.streamlit.io/)
- [GitHub do Streamlit](https://github.com/streamlit/streamlit)
```

## Considera√ß√µes Finais

- O Streamlit Community Cloud √© otimizado para aplica√ß√µes data-centric que n√£o exigem recursos computacionais pesados
- Para aplica√ß√µes mais complexas ou que precisem de maior controle, considere hospedar em servi√ßos como Heroku, AWS, GCP ou Azure
- Lembre-se que o deploy no Streamlit Community Cloud publica sua aplica√ß√£o publicamente - para aplica√ß√µes privadas considere sua pr√≥pria infraestrutura ou planos empresariais do Streamlit

Estas diretrizes completas abrangem todos os aspectos essenciais para desenvolver e implantar com sucesso uma vers√£o web do GoNetwork usando Streamlit, garantindo compatibilidade total com o Streamlit Community Cloud.
